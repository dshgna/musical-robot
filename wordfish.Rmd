---
title: "Wordfish"
date: "11/05/2021"
output: html_document
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  echo = TRUE,
  fig.path = "../report/images/",
  dev = "png",
  dpi = 300,
  cache = TRUE
  )
library(quanteda)
library(quanteda.textmodels)
library(tidyverse)
```


```{r load_data}
load(file = "blasphemy_dfm.rda")
head(blasphemy_dfm)
```


```{r}
# Group by region
blasphemy_dfm_grouped <- blasphemy_dfm %>%
  dfm_group(groups = 'region')
```


## Wordfish

```{r wordfish}
# Fit the wordfish model and set identification
# TODO: Find reference observations
(blasphemy_wordfish <- textmodel_wordfish(blasphemy_dfm_grouped, dir = c(3,1)))
```


```{r plot_wordfish}
textplot_scale1d(blasphemy_wordfish)
```

## Eiffel Tower

```{r}
set.seed(1234)
sample_highlight <- sample(featnames(blasphemy_dfm_grouped), 8)

# Plot the Eiffel Tower plot
textplot_scale1d(blasphemy_wordfish, margin = c("features"), 
                 highlighted = sample_highlight)
```

